<!DOCTYPE html>
<html lang="zh_CN" id="htmlRoot">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="renderer" content="webkit" />
  <meta name="viewport"
    content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0" />

  <title>
    <%= title %>
  </title>
  <link rel="icon" href="/logo.png" />
  <!-- 全局配置 -->
  <script src="https://api.tianditu.gov.cn/api?v=4.0&tk=e86efcefbe0980b099543681146fb53d" type="text/javascript"></script>
  <!-- <script src="./tianditu.js" type="text/javascript"></script> -->
  <script>
    window._CONFIG = {};
  </script>
</head>

<body>
  <script>
    // (() => {
    //   var htmlRoot = document.getElementById('htmlRoot');
    //   var theme = window.localStorage.getItem('__APP__DARK__MODE__');
    //   if (htmlRoot && theme) {
    //     htmlRoot.setAttribute('data-theme', theme);
    //     theme = htmlRoot = null;
    //   }
    // })();
    (() => {
  let progressInterval;
  let startTime;
  const MAX_PROGRESS = 95; // 最大值
  const MAX_TIME = 5000;   // 模拟最大加载时间（毫秒）
  const STEP_INTERVAL = 100; // 每次更新的间隔

  function initProgress() {
    const progressFill = document.querySelector('.progress-fill');
    if (!progressFill) {
      setTimeout(initProgress, 50);
      return;
    }

    // 初始状态
    progressFill.style.width = '0%';
    progressFill.style.display = 'block';
    startTime = Date.now();

    function updateProgress() {
      const elapsed = Date.now() - startTime;
      const t = Math.min(elapsed / MAX_TIME, 1); // 0 ~ 1

      // 缓动公式（easeOutCubic）
      const eased = 1 - Math.pow(1 - t, 3);

      let progress = eased * MAX_PROGRESS;
      progressFill.style.width = progress.toFixed(2) + '%';
    }

    // 循环更新
    progressInterval = setInterval(updateProgress, STEP_INTERVAL);

    // 页面加载完成时平滑到 100%
    window.addEventListener('load', () => {
      clearInterval(progressInterval);
      progressFill.style.transition = 'width 2s ease-out';
      progressFill.style.width = '95%';
    });
  }

  initProgress();
})();
  </script>
  <div id="app">
    <style>
      .app-loading {
        display: flex;
        width: 100%;
        height: 100%;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        background-color: #f4f7f9;
      }

      .app-loading .app-loading-wrap {
        position: absolute;
        top: 50%;
        left: 50%;
        display: flex;
        -webkit-transform: translate3d(-50%, -50%, 0);
        transform: translate3d(-50%, -50%, 0);
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }
        /* 进度条样式 */
        .app-loading .progress-container {
          width: 300px;
          margin: 20px 0;
        }

        .app-loading .progress-bar {
          width: 100%;
          height: 4px;
          background-color: #e8e8e8;
          border-radius: 2px;
          overflow: hidden;
          position: relative;
        }

        .app-loading .progress-fill {
          height: 100%;
          /* background: linear-gradient(90deg, #0065cc, #1890ff, #40a9ff, #1890ff, #0065cc) !important;
          background-size: 200% 100% !important;
          animation: gradientMove 2s linear infinite; */
          border-radius: 2px;
          width: 0%;
          transition: width 0.1s ease-out;
          position: relative;
          display: block;
          min-height: 4px;
        }

        .app-loading .progress-fill::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(90deg, #0065cc, #1890ff, #40a9ff, #1890ff, #0065cc);
          background-size: 200% 100%;
          animation: gradientMove 2s linear infinite;
          border-radius: 2px;
          z-index: 1;
        }

        @keyframes gradientMove {
          0% {
            background-position: 200% 50%;
          }
          100% {
            background-position: 0% 50%;
          }
        }


        /* 暗色主题下的进度条样式 */
        html[data-theme='dark'] .app-loading .progress-bar {
          background-color: #434343;
        }

        html[data-theme='dark'] .app-loading .progress-fill {
          background: linear-gradient(90deg, #177ddc, #1890ff, #40a9ff, #1890ff, #177ddc) !important;
          background-size: 200% 100% !important;
          animation: gradientMove 2s linear infinite;
        }

        html[data-theme='dark'] .app-loading .progress-fill::before {
          background: linear-gradient(90deg, #177ddc, #1890ff, #40a9ff, #1890ff, #177ddc);
        }

        /* 原有的loading样式 - 已注释 */
        /*

      html[data-theme='dark'] .app-loading {
        background-color: #2c344a;
      }

      html[data-theme='dark'] .app-loading .app-loading-title {
        color: rgba(255, 255, 255, 0.85);
      }

      .app-loading {
        display: flex;
        width: 100%;
        height: 100%;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        background-color: #f4f7f9;
      }

      .app-loading .app-loading-wrap {
        position: absolute;
        top: 50%;
        left: 50%;
        display: flex;
        -webkit-transform: translate3d(-50%, -50%, 0);
        transform: translate3d(-50%, -50%, 0);
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }

      .app-loading .dots {
        display: flex;
        padding: 98px;
        justify-content: center;
        align-items: center;
      }

      .app-loading .app-loading-title {
        display: flex;
        margin-top: 30px;
        font-size: 30px;
        color: rgba(0, 0, 0, 0.85);
        justify-content: center;
        align-items: center;
      }

      .app-loading .app-loading-logo {
        display: block;
        width: 90px;
        margin: 0 auto;
        margin-bottom: 20px;
      }

      .dot {
        position: relative;
        display: inline-block;
        width: 48px;
        height: 48px;
        margin-top: 30px;
        font-size: 32px;
        transform: rotate(45deg);
        box-sizing: border-box;
        animation: antRotate 1.2s infinite linear;
      }

      .dot i {
        position: absolute;
        display: block;
        width: 20px;
        height: 20px;
        background-color: #0065cc;
        border-radius: 100%;
        opacity: 0.3;
        transform: scale(0.75);
        animation: antSpinMove 1s infinite linear alternate;
        transform-origin: 50% 50%;
      }

      .dot i:nth-child(1) {
        top: 0;
        left: 0;
      }

      .dot i:nth-child(2) {
        top: 0;
        right: 0;
        -webkit-animation-delay: 0.4s;
        animation-delay: 0.4s;
      }

      .dot i:nth-child(3) {
        right: 0;
        bottom: 0;
        -webkit-animation-delay: 0.8s;
        animation-delay: 0.8s;
      }

      .dot i:nth-child(4) {
        bottom: 0;
        left: 0;
        -webkit-animation-delay: 1.2s;
        animation-delay: 1.2s;
      }

      @keyframes antRotate {
        to {
          -webkit-transform: rotate(405deg);
          transform: rotate(405deg);
        }
      }

      @-webkit-keyframes antRotate {
        to {
          -webkit-transform: rotate(405deg);
          transform: rotate(405deg);
        }
      }

      @keyframes antSpinMove {
        to {
          opacity: 1;
        }
      }

      @-webkit-keyframes antSpinMove {
        to {
          opacity: 1;
        }
      }
      */
    </style>
    <div class="app-loading">
      <div class="app-loading-wrap">
          <!-- 新的进度条样式 -->
          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
          </div>
          
          <!-- 原有的loading元素 - 已注释 -->
          <!--
        <img src="/resource/img/logo.png" class="app-loading-logo" alt="Logo" />
        <div class="app-loading-dots">
          <span class="dot dot-spin"><i></i><i></i><i></i><i></i></span>
        </div>
        <div class="app-loading-title">
          <%= title %>
        </div>
        -->
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.ts"></script>
</body>

</html>
